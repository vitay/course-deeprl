<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.5.57">

  <meta name="author" content="Julien Vitay">
  <title>Deep Reinforcement Learning</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #24292e;  }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #24292e; } /* Normal */
    code span.al { color: #ff5555; font-weight: bold; } /* Alert */
    code span.an { color: #6a737d; } /* Annotation */
    code span.at { color: #d73a49; } /* Attribute */
    code span.bn { color: #005cc5; } /* BaseN */
    code span.bu { color: #d73a49; } /* BuiltIn */
    code span.cf { color: #d73a49; } /* ControlFlow */
    code span.ch { color: #032f62; } /* Char */
    code span.cn { color: #005cc5; } /* Constant */
    code span.co { color: #6a737d; } /* Comment */
    code span.cv { color: #6a737d; } /* CommentVar */
    code span.do { color: #6a737d; } /* Documentation */
    code span.dt { color: #d73a49; } /* DataType */
    code span.dv { color: #005cc5; } /* DecVal */
    code span.er { color: #ff5555; text-decoration: underline; } /* Error */
    code span.ex { color: #d73a49; font-weight: bold; } /* Extension */
    code span.fl { color: #005cc5; } /* Float */
    code span.fu { color: #6f42c1; } /* Function */
    code span.im { color: #032f62; } /* Import */
    code span.in { color: #6a737d; } /* Information */
    code span.kw { color: #d73a49; } /* Keyword */
    code span.op { color: #24292e; } /* Operator */
    code span.ot { color: #6f42c1; } /* Other */
    code span.pp { color: #d73a49; } /* Preprocessor */
    code span.re { color: #6a737d; } /* RegionMarker */
    code span.sc { color: #005cc5; } /* SpecialChar */
    code span.ss { color: #032f62; } /* SpecialString */
    code span.st { color: #032f62; } /* String */
    code span.va { color: #e36209; } /* Variable */
    code span.vs { color: #032f62; } /* VerbatimString */
    code span.wa { color: #ff5555; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    padding-bottom: 0.5rem;
    margin-bottom: 0;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" data-background-image="img/tuc-new-large.png" data-background-opacity="1" data-background-position="top" data-background-size="30%" class="quarto-title-block center">
  <h1 class="title">Deep Reinforcement Learning</h1>
  <p class="subtitle">Markov Decision Process</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Julien Vitay 
</div>
        <p class="quarto-title-affiliation">
            Professur für Künstliche Intelligenz - Fakultät für Informatik
          </p>
    </div>
</div>

</section>
<section id="markov-decision-process" class="title-slide slide level1 center">
<h1>1 - Markov Decision Process</h1>

</section>

<section id="markov-decision-process-mdp" class="title-slide slide level1 center">
<h1>Markov Decision Process (MDP)</h1>
<ul>
<li>The kind of task that can be solved by RL is called a <strong>Markov Decision Process</strong> (MDP).</li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/rl-loop.png"></p>
<figcaption>Source: David Silver. <a href="http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html" class="uri">http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html</a></figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p>The environment is <strong>fully observable</strong>, i.e.&nbsp;the current state <span class="math inline">s_t</span> completely characterizes the process at time <span class="math inline">t</span>.</p></li>
<li><p><strong>Actions</strong> <span class="math inline">a_t</span> provoke transitions between two states <span class="math inline">s_t</span> and <span class="math inline">s_{t+1}</span>.</p></li>
<li><p>State transitions <span class="math inline">(s_t, a_t, s_{t+1})</span> are governed by <strong>transition probabilities</strong>.</p></li>
<li><p>A <strong>reward</strong> <span class="math inline">r_{t+1}</span> is (probabilistically) associated to each transition.</p></li>
</ul>
</div></div>
<ul>
<li>Note: n-armed bandits are MDPs with only one state.</li>
</ul>
</section>

<section id="finite-state-machine-fsm" class="title-slide slide level1 center">
<h1>Finite State Machine (FSM)</h1>
<ul>
<li><p>A <strong>finite state machine</strong> (or finite state automaton) is a mathematical model of computation.</p></li>
<li><p>A FSM can only be in a single <strong>state</strong> <span class="math inline">s</span> at any given time.</p></li>
<li><p><strong>Transitions</strong> between states are governed by external inputs, when some condition is met.</p></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/fsm.png"></p>
<figcaption>Source: <a href="https://web.stanford.edu/class/archive/cs/cs103/cs103.1142/button-fsm/" class="uri">https://web.stanford.edu/class/archive/cs/cs103/cs103.1142/button-fsm/</a></figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p>A FSM is fully defined by:</p>
<ul>
<li><p>The <strong>state set</strong> <span class="math inline">\mathcal{S} = \{ s_i\}_{i=1}^N</span>.</p></li>
<li><p>Its initial state <span class="math inline">S_0</span>.</p></li>
<li><p>A list of <strong>conditions</strong> for each transition.</p></li>
</ul></li>
<li><p>Usually implemented by a series of if/then/else statements:</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> state <span class="op">==</span> <span class="st">"hover"</span> <span class="kw">and</span> press <span class="op">==</span> true:</span>
<span id="cb1-2"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a aria-hidden="true" tabindex="-1"></a>    state <span class="op">=</span> <span class="st">"pressed"</span></span>
<span id="cb1-4"><a aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> ...</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div>
</section>

<section id="markov-chain-mc" class="title-slide slide level1 center">
<h1>Markov Chain (MC)</h1>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/student-markovchain.png"></p>
<figcaption>Source: David Silver. <a href="http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html" class="uri">http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html</a></figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p>A first-order <strong>Markov chain</strong> (or Markov process) is a stochastic process generated by a FSM, where transitions between states are governed by <strong>state transition probabilities</strong>.</p></li>
<li><p>A Markov chain is defined by:</p>
<ul>
<li><p>The <strong>state set</strong> <span class="math inline">\mathcal{S} = \{ s_i\}_{i=1}^N</span>.</p></li>
<li><p>The <strong>state transition probability function</strong>:</p></li>
</ul>
<p><span class="math display">
  \begin{aligned}
      \mathcal{P}: \mathcal{S} \rightarrow &amp; P(\mathcal{S}) \\
      p(s' | s) &amp; =  P (s_{t+1} = s' | s_t = s) \\
  \end{aligned}
  </span></p></li>
<li><p>When the states have the <strong>Markov property</strong>, the state transition probabilities fully describe the MC.</p></li>
</ul>
</div></div>
</section>

<section id="markov-property" class="title-slide slide level1 center">
<h1>Markov property</h1>
<ul>
<li>The Markov property states that:</li>
</ul>
<blockquote>
<p>The future is independent of the past given the present.</p>
</blockquote>
<ul>
<li>Formally, the state <span class="math inline">s_t</span> (state at time <span class="math inline">t</span>) is <strong>Markov</strong> (or Markovian) if and only if:</li>
</ul>
<p><span class="math display">
    P(s_{t+1} | s_t) = P(s_{t+1} | s_t, s_{t-1}, \ldots, s_0)
</span></p>
<ul>
<li><p>The knowledge of the current state <span class="math inline">s_t</span> is <strong>enough</strong> to predict in which state <span class="math inline">s_{t+1}</span> the system will be at the next time step.</p></li>
<li><p>We do not need the whole <strong>history</strong> <span class="math inline">\{s_0, s_1, \ldots, s_t\}</span> of the system to predict what will happen.</p></li>
<li><p>Note: if we need <span class="math inline">s_{t-1}</span> and <span class="math inline">s_t</span> to predict <span class="math inline">s_{t+1}</span>, we have a second-order Markov chain.</p></li>
</ul>
</section>

<section id="markov-property-1" class="title-slide slide level1 center">
<h1>Markov property</h1>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/student-markovchain.png"></p>
<figcaption>Source: David Silver. <a href="http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html" class="uri">http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html</a></figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p>For example, the probability 0.8 of transitioning from “Class 2” to “Class 3” is the same regardless we were in “Class 1” or “Pub” before.</p></li>
<li><p>If this is not the case, the states are not Markov, and this is not a Markov chain.</p></li>
<li><p>We would need to create two distinct states:</p>
<ul>
<li><p>“Class 2 coming from Class 1”</p></li>
<li><p>“Class 2 coming from the pub”</p></li>
</ul></li>
</ul>
</div></div>
</section>

<section id="state-transition-matrix" class="title-slide slide level1 center">
<h1>State transition matrix</h1>
<div class="columns">
<div class="column" style="width:40%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/student-markovchain.png"></p>
<figcaption>Source: David Silver. <a href="http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html" class="uri">http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html</a></figcaption>
</figure>
</div>
</div><div class="column" style="width:60%;">
<ul>
<li>Supposing that the states have the Markov property, the transitions in the system can be summarized by the <strong>state transition matrix</strong> <span class="math inline">\mathcal{P}</span>:</li>
</ul>
<p><img data-src="img/student-transitionmatrix.png"></p>
</div></div>
<ul>
<li>Each element of the state transition matrix corresponds to <span class="math inline">p(s' | s)</span>. Each row of the state transition matrix sums to 1:</li>
</ul>
<p><span class="math display">\sum_{s'} p(s' | s)  = 1</span></p>
<ul>
<li>The tuple <span class="math inline">&lt;\mathcal{S}, \mathcal{P}&gt;</span> fully describes the Markov chain.</li>
</ul>
</section>

<section id="markov-reward-process-mrp" class="title-slide slide level1 center">
<h1>Markov Reward Process (MRP)</h1>
<ul>
<li><p>A <strong>Markov Reward Process</strong> is a Markov Chain where each transition is associated with a scalar <strong>reward</strong> <span class="math inline">r</span>, coming from some probability distribution.</p></li>
<li><p>A Markov Reward Process is defined by the tuple <span class="math inline">&lt;\mathcal{S}, \mathcal{P}, \mathcal{R}, \gamma&gt;</span>.</p></li>
</ul>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/student-mrp.png"></p>
<figcaption>Source: David Silver. <a href="http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html" class="uri">http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html</a></figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<ol type="1">
<li><p>The finite <strong>state set</strong> <span class="math inline">\mathcal{S}</span>.</p></li>
<li><p>The <strong>state transition probability function</strong>:</p></li>
</ol>
<p><span class="math display">
\begin{aligned}
    \mathcal{P}: \mathcal{S} \rightarrow &amp; P(\mathcal{S}) \\
    p(s' | s) &amp; =  P (s_{t+1} = s' | s_t = s) \\
\end{aligned}
</span></p>
<ol start="3" type="1">
<li>The <strong>expected reward function</strong>:</li>
</ol>
<p><span class="math display">
\begin{aligned}
    \mathcal{R}: \mathcal{S} \times \mathcal{S} \rightarrow &amp; \Re \\
    r(s, s') &amp;=  \mathbb{E} (r_{t+1} | s_t = s, s_{t+1} = s') \\
\end{aligned}
</span></p>
<ol start="4" type="1">
<li>The <strong>discount factor</strong> <span class="math inline">\gamma \in [0, 1]</span>.</li>
</ol>
</div></div>
</section>

<section id="expected-reward" class="title-slide slide level1 center">
<h1>Expected reward</h1>
<ul>
<li>As with n-armed bandits, we only care about the <strong>expected reward</strong> received during a transition <span class="math inline">s \rightarrow s'</span> (<em>on average</em>), but the actual reward received <span class="math inline">r_{t+1}</span> may vary around the expected value.</li>
</ul>
<p><span class="math display">r(s, s') =  \mathbb{E} (r_{t+1} | s_t = s, s_{t+1} = s')</span></p>

<img data-src="img/bandit-example.png" class="r-stretch"></section>

<section id="return" class="title-slide slide level1 center">
<h1>Return</h1>
<ul>
<li>The main difference with n-armed bandits is that the MRP will be in a sequence of states (possibly infinite):</li>
</ul>
<p><span class="math display">s_0 \rightarrow s_1 \rightarrow s_2  \rightarrow \ldots \rightarrow s_T</span></p>
<p>and collect a sequence of reward samples:</p>
<p><span class="math display">r_1 \rightarrow r_2 \rightarrow r_3  \rightarrow \ldots \rightarrow r_{T}</span></p>
<ul>
<li>In a MRP, we are interested in estimating the <strong>return</strong> <span class="math inline">R_t</span>, i.e.&nbsp;the discounted sum of <strong>future</strong> rewards after the step <span class="math inline">t</span>:</li>
</ul>
<p><span class="math display">
    R_t = r_{t+1} + \gamma \, r_{t+2} + \gamma^2 \, r_{t+3} + \ldots = \sum_{k=0}^\infty \gamma^k \, r_{t+k+1}
</span></p>
<ul>
<li><p>Meaning: how much reward will I <strong>collect</strong> from now on?</p></li>
<li><p>Of course, you never know the return at time <span class="math inline">t</span>: transitions and rewards are probabilistic, so the received rewards in the future are not exactly predictable at <span class="math inline">t</span>.</p></li>
<li><p><span class="math inline">R_t</span> is therefore purely theoretical: RL is all about <strong>estimating</strong> the return.</p></li>
</ul>
</section>

<section id="discount-factor" class="title-slide slide level1 center">
<h1>Discount factor</h1>
<p><span class="math display">
    R_t = r_{t+1} + \gamma \, r_{t+2} + \gamma^2 \, r_{t+3} + \ldots = \sum_{k=0}^\infty \gamma^k \, r_{t+k+1}
</span></p>
<ul>
<li><p>The <strong>discount factor</strong> (or discount rate, or discount) <span class="math inline">\gamma \in [0, 1]</span> is a very important parameter in RL:</p>
<ul>
<li><p>It defines the <strong>present value of future rewards</strong>.</p></li>
<li><p>Receiving 10 euros now has a higher <strong>value</strong> than receiving 10 euros in ten years, although the reward is the same: you do not have to wait.</p></li>
<li><p>The value of receiving a reward <span class="math inline">r</span> after <span class="math inline">k+1</span> time steps is <span class="math inline">\gamma^k \, r</span>.</p></li>
<li><p><strong>Immediate rewards</strong> are better than <strong>delayed rewards</strong>.</p></li>
</ul></li>
<li><p>When <span class="math inline">\gamma &lt; 1</span>, <span class="math inline">\gamma^k</span> tends to 0 when <span class="math inline">k</span> goes to infinity: this makes sure that the return is always <strong>finite</strong>.</p>
<ul>
<li><p>Particularly important when the MRP is cyclic / periodic.</p></li>
<li><p>If all sequences terminate at some time step <span class="math inline">T</span>, we can set <span class="math inline">\gamma= 1</span>.</p></li>
</ul></li>
</ul>
</section>

<section id="markov-decision-process-mdp-1" class="title-slide slide level1 center">
<h1>Markov Decision Process (MDP)</h1>
<ul>
<li><p>A <strong>Markov Decision Process</strong> is a MRP where transitions are influenced by <strong>actions</strong> <span class="math inline">a \in \mathcal{A}</span>.</p></li>
<li><p>A finite MDP is defined by the tuple <span class="math inline">&lt;\mathcal{S}, \mathcal{A}, \mathcal{P}, \mathcal{R}, \gamma&gt;</span>:</p>
<ol type="1">
<li><p>The finite <strong>state set</strong> <span class="math inline">\mathcal{S}</span>.</p></li>
<li><p>The finite <strong>action set</strong> <span class="math inline">\mathcal{A}</span>.</p></li>
<li><p>The <strong>state transition probability function</strong>:</p></li>
</ol>
<p><span class="math display">
  \begin{aligned}
      \mathcal{P}: \mathcal{S} \times \mathcal{A} \rightarrow &amp; P(\mathcal{S}) \\
      p(s' | s, a) &amp; =  P (s_{t+1} = s' | s_t = s, a_t = a) \\
  \end{aligned}
  </span></p>
<ol start="4" type="1">
<li>The <strong>expected reward function</strong>:</li>
</ol>
<p><span class="math display">
  \begin{aligned}
      \mathcal{R}: \mathcal{S} \times \mathcal{A} \times \mathcal{S} \rightarrow &amp; \Re \\
      r(s, a, s') &amp;=  \mathbb{E} (r_{t+1} | s_t = s, a_t = a, s_{t+1} = s') \\
  \end{aligned}
  </span></p>
<ol start="5" type="1">
<li>The <strong>discount factor</strong> <span class="math inline">\gamma \in [0, 1]</span>.</li>
</ol></li>
</ul>
</section>

<section id="markov-decision-process-mdp-2" class="title-slide slide level1 center">
<h1>Markov Decision Process (MDP)</h1>

<img data-src="img/student-mdp.png" style="width:75.0%" class="r-stretch quarto-figure-center"><p class="caption">Source: David Silver. <a href="http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html" class="uri">http://www0.cs.ucl.ac.uk/staff/d.silver/web/Teaching.html</a></p></section>

<section id="transition-and-reward-probabilities" class="title-slide slide level1 center">
<h1>Transition and reward probabilities</h1>
<ul>
<li>Why do we need transition probabilities in RL?</li>
</ul>
<p><span class="math display"> p(s' | s, a) =  P (s_{t+1} = s' | s_t = s, a_t = a)</span></p>
<ul>
<li><p>Some RL tasks are <strong>deterministic</strong>: an action <span class="math inline">a</span> in a state <span class="math inline">s</span> always leads to the state <span class="math inline">s'</span>:</p>
<ul>
<li>Board games, video games…</li>
</ul></li>
<li><p>Others are <strong>stochastic</strong>: the same action <span class="math inline">a</span> can lead to different states <span class="math inline">s'</span>:</p>
<ul>
<li><p>Casino games (throwing a dice, etc)</p></li>
<li><p>Two-opponent games (the next state depends on what the other player chooses).</p></li>
<li><p>Uncertainty (shoot at basketball, slippery wheels, robotic grasping).</p></li>
</ul></li>
<li><p>For a transition <span class="math inline">(s, a, s')</span>, the received reward can be also stochastic:</p>
<ul>
<li>Casino games (armed bandit), incomplete information, etc.</li>
</ul>
<p><span class="math display"> r(s, a, s') =  \mathbb{E} (r_{t+1} | s_t = s, a_t = a, s_{t+1} = s')</span></p>
<ul>
<li>Most of the problems we will see in this course have deterministic rewards, but we only care about expectations anyway.</li>
</ul></li>
</ul>
</section>

<section id="the-markov-property-for-a-mdp" class="title-slide slide level1 center">
<h1>The Markov property for a MDP</h1>
<ul>
<li><p>The state of the agent at step <span class="math inline">t</span> refers to whatever information is available about its environment or its own “body”.</p></li>
<li><p>The state can include immediate “sensations”, highly processed sensations, and structures built up over time from sequences of sensations.</p></li>
<li><p>A state should summarize all past sensations so as to retain all essential information, i.e.&nbsp;it should have the <strong>Markov Property</strong>:</p></li>
</ul>
<p><span class="math display">\begin{aligned}
     P( s_{t+1} = s, r_{t+1} = r &amp; | s_t, a_t, r_t, s_{t-1}, a_{t-1}, ..., s_0, a_0) = P( s_{t+1} = s, r_{t+1} = r | s_t, a_t ) \\
     &amp;\text{for all s, r, and past histories} \quad (s_{t}, a_{t}, ..., s_0, a_0)
\end{aligned}
</span></p>
<ul>
<li><p>This means that the current state representation <span class="math inline">s</span> contains enough information to predict the probability of arriving in the next state <span class="math inline">s'</span> given the chosen action <span class="math inline">a</span>.</p></li>
<li><p>When the Markovian property is not met, we have a <strong>Partially-Observable Markov Decision Process</strong> (POMDP).</p></li>
</ul>
</section>

<section id="markov-property-2" class="title-slide slide level1 center">
<h1>Markov property</h1>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/markov-example.jpeg"></p>
<figcaption>Source: <a href="https://medium.com/emergent-future/simple-reinforcement-learning-with-tensorflow-part-6-partial-observability-and-deep-recurrent-q-68463e9aeefc" class="uri">https://medium.com/emergent-future/simple-reinforcement-learning-with-tensorflow-part-6-partial-observability-and-deep-recurrent-q-68463e9aeefc</a></figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p>Where is the ball going? To the little girl or to the player?</p></li>
<li><p>Single <strong>video frames</strong> are not Markov states: you cannot generally predict what will happen based on a single image.</p></li>
<li><p>A simple solution is to <strong>stack</strong> or <strong>concatenate</strong> multiple frames:</p>
<ul>
<li>By measuring the displacement of the ball between two consecutive frames, we can predict where it is going.</li>
</ul></li>
</ul>
</div></div>
<ul>
<li>One can also <strong>learn</strong> state representations containing the history using recurrent neural networks (see later).</li>
</ul>
</section>

<section id="pomdp-partially-observable-markov-decision-process" class="title-slide slide level1 center">
<h1>POMDP : Partially-Observable Markov Decision Process</h1>
<div class="columns">
<div class="column" style="width:50%;">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="img/pomdp.png"></p>
<figcaption>Source: <a href="https://artint.info/html/ArtInt_230.html" class="uri">https://artint.info/html/ArtInt_230.html</a></figcaption>
</figure>
</div>
</div><div class="column" style="width:50%;">
<ul>
<li><p>In a POMDP, the agent does not have access to the true state <span class="math inline">s_t</span> of the environment, but only <strong>observations</strong> <span class="math inline">o_t</span>.</p></li>
<li><p>Observations are partial views of the state, without the Markov property.</p></li>
<li><p>The dynamics of the environment (transition probabilities, reward expectations) only depend on the state, not the observations.</p></li>
<li><p>The agent can only make decisions (actions) based on the sequence of observations, as it does not have access to the state directly (Plato’s cavern).</p></li>
</ul>
</div></div>
<ul>
<li>In a POMDP, the state <span class="math inline">s_t</span> of the agent is implicitly the concatenation of the past observations and actions:</li>
</ul>
<p><span class="math display">
s_t = (o_0, a_0, o_1, a_1, \ldots, a_{t-1}, o_t)
</span></p>
<ul>
<li>Under conditions, this inferred state can have the Markov property and the POMDP is solvable.</li>
</ul>
</section>

<section id="return-1" class="title-slide slide level1 center">
<h1>Return</h1>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li>Suppose the sequence of rewards obtained after step <span class="math inline">t</span> (after being in state <span class="math inline">s_t</span> and choosing action <span class="math inline">a_t</span>) is:</li>
</ul>
<p><span class="math display"> r_{t+1}, r_{t+2}, r_{t+3}, ... </span></p>
<ul>
<li>What we want to maximize is the <strong>return</strong> (reward-to-go) at each time step <span class="math inline">t</span>, i.e.&nbsp;the sum of all future rewards:</li>
</ul>
<p><span class="math display">
    R_t = r_{t+1} + \gamma \, r_{t+2} +  \gamma^2 \, r_{t+3} + ... = \sum_{k=0}^{\infty} \gamma^k \, r_{t+k+1}
</span></p>
</div><div class="column" style="width:30%;">
<p><img data-src="img/rewardtogo.png"></p>
</div></div>
<ul>
<li>More generally, for a trajectory (episode) <span class="math inline">\tau = (s_0, a_0, r_1, s_1, a_1, \ldots, s_T)</span>, one can define its return as:</li>
</ul>
<p><span class="math display"> R(\tau) = \sum_{t=0}^{T} \gamma^t \, r_{t+1} </span></p>
<p><img data-src="img/rl-sequence.jpg" style="width:60.0%"></p>
</section>

<section id="return-2" class="title-slide slide level1 center">
<h1>Return</h1>

<img data-src="img/unifiedreturn.png" style="width:50.0%" class="r-stretch"><ul>
<li><p>For <strong>episodic tasks</strong> (which break naturally into finite episodes of length <span class="math inline">T</span>, e.g.&nbsp;plays of a game, trips through a maze), the return is always finite and easy to compute at the end of the episode.</p>
<ul>
<li>The discount factor can be set to 1.</li>
</ul>
<p><span class="math display">
      R_t = \sum_{k=0}^{T} r_{t+k+1}
  </span></p></li>
<li><p>For <strong>continuing tasks</strong> (which can not be split into episodes), the return could become infinite if <span class="math inline">\gamma = 1</span>.</p>
<ul>
<li>The discount factor has to be smaller than 1.</li>
</ul>
<p><span class="math display">
      R_t = \sum_{k=0}^{\infty} \gamma^k \, r_{t+k+1}
  </span></p></li>
<li><p>The discount rate <span class="math inline">\gamma</span> determines the relative importance of future rewards for the behavior:</p>
<ul>
<li><p>if <span class="math inline">\gamma</span> is close to 0, only the immediately available rewards will count: the agent is greedy or <strong>myopic</strong>.</p></li>
<li><p>if <span class="math inline">\gamma</span> is close to 1, even far-distance rewards will be taken into account: the agent is <strong>farsighted</strong>.</p></li>
</ul></li>
</ul>
</section>

<section id="why-the-reward-on-the-long-term" class="title-slide slide level1 center">
<h1>Why the reward on the long term?</h1>
<div>
<p><img data-src="img/return-example.svg" style="width:60.0%"></p>
</div>
<ul>
<li><p>Selecting the action <span class="math inline">a_1</span> in <span class="math inline">s_1</span> does not bring reward immediately (<span class="math inline">r_1 = 0</span>) but allows to reach <span class="math inline">s_5</span> in the future and get a reward of 10.</p></li>
<li><p>Selecting <span class="math inline">a_2</span> in <span class="math inline">s_1</span> brings immediately a reward of 1, but that will be all.</p></li>
<li><p><span class="math inline">a_1</span> is <strong>better</strong> than <span class="math inline">a_2</span>, because it will bring more reward <strong>on the long term</strong>.</p></li>
</ul>
</section>

<section id="why-the-reward-on-the-long-term-1" class="title-slide slide level1 center">
<h1>Why the reward on the long term?</h1>
<div>
<p><img data-src="img/return-example.svg" style="width:60.0%"></p>
</div>
<ul>
<li>When selecting <span class="math inline">a_1</span> in <span class="math inline">s_1</span>, the discounted return is:</li>
</ul>
<p><span class="math display">
    R = 0 + \gamma \, 0 + \gamma^2 \, 0 + \gamma^3 \, 10 + \ldots = 10 \, \gamma^3
</span></p>
<p>while it is <span class="math inline">R= 1</span> for the action <span class="math inline">a_2</span>.</p>
<ul>
<li><p>For small values of <span class="math inline">\gamma</span> (e.g.&nbsp;0.1), <span class="math inline">10\, \gamma^3</span> becomes smaller than one, so the action <span class="math inline">a_2</span> leads to a higher discounted return.</p></li>
<li><p>The discount rate <span class="math inline">\gamma</span> changes the behavior of the agent. It is usually taken somewhere between 0.9 and 0.999.</p></li>
</ul>
</section>

<section id="example-the-cartpole-balancing-task" class="title-slide slide level1 center">
<h1>Example: the cartpole balancing task</h1>
<div class="columns">
<div class="column" style="width:50%;">
<p><img data-src="img/cartpole-after.gif" style="width:60.0%"></p>
</div><div class="column" style="width:50%;">
<ul>
<li><p><strong>State:</strong> Position and velocity of the cart, angle and speed of the pole.</p></li>
<li><p><strong>Actions:</strong> Commands to the motors for going left or right.</p></li>
<li><p><strong>Reward function:</strong> Depends on whether we consider the task as episodic or continuing.</p></li>
</ul>
</div></div>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p><strong>Episodic</strong> task where episode ends upon failure:</p>
<ul>
<li><p><strong>reward</strong> = +1 for every step before failure, 0 at failure.</p></li>
<li><p><strong>return</strong> = number of steps before failure.</p></li>
</ul></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li><p><strong>Continuing</strong> task with discounted return:</p>
<ul>
<li><p><strong>reward</strong> = -1 at failure, 0 otherwise.</p></li>
<li><p><strong>return</strong> = <span class="math inline">- \gamma^k</span> for <span class="math inline">k</span> steps before failure.</p></li>
</ul></li>
</ul>
</div></div>
<ul>
<li>In both cases, the goal is to maximize the return by maintaining the pole vertical as long as possible.</li>
</ul>
</section>

<section id="example-the-recycling-robot-mdp" class="title-slide slide level1 center">
<h1>Example: the recycling robot MDP</h1>
<div class="columns">
<div class="column" style="width:40%;">
<p><img data-src="img/walle.jpg"></p>
</div><div class="column" style="width:50%;">
<ul>
<li><p>At each step, the robot has to decide whether it should:</p>
<ol type="1">
<li>actively search for a can,</li>
<li>wait for someone to bring it a can, or</li>
<li>go to home base and recharge.</li>
</ol></li>
<li><p>Searching is better (more reward) but runs down the battery (probability 1-<span class="math inline">\alpha</span> to empty the battery): if the robot runs out of power while searching, he has to be rescued (which leads to punishment and should be avoided).</p></li>
<li><p>Decisions must be made on basis of the current energy level: high, low. This will be the state of the robot.</p></li>
<li><p>Return = number of cans collected.</p></li>
</ul>
</div></div>
</section>

<section id="example-the-recycling-robot-mdp-1" class="title-slide slide level1 center">
<h1>Example: the recycling robot MDP</h1>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p><span class="math inline">\mathcal{S} = \{ \text{high}, \text{low} \}</span></p></li>
<li><p><span class="math inline">\mathcal{A}(\text{high} ) = \{ \text{search}, \text{wait} \}</span></p></li>
<li><p><span class="math inline">\mathcal{A}(\text{low} ) = \{ \text{search}, \text{wait}, \text{recharge} \}</span></p></li>
</ul>
</div><div class="column" style="width:50%;">
<ul>
<li><p><span class="math inline">R^{\text{search}}</span> = expected number of cans while searching.</p></li>
<li><p><span class="math inline">R^{\text{wait}}</span> = expected number of cans while waiting.</p></li>
<li><p><span class="math inline">R^{\text{search}} &gt; R^{\text{wait}}</span></p></li>
</ul>
</div></div>
<div>
<p><img data-src="img/recyclingrobot.png" style="width:70.0%"></p>
</div>
</section>

<section id="example-the-recycling-robot-mdp-2" class="title-slide slide level1 center">
<h1>Example: the recycling robot MDP</h1>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p><span class="math inline">\mathcal{S} = \{ \text{high}, \text{low} \}</span></p></li>
<li><p><span class="math inline">\mathcal{A}(\text{high} ) = \{ \text{search}, \text{wait} \}</span></p></li>
<li><p><span class="math inline">\mathcal{A}(\text{low} ) = \{ \text{search}, \text{wait}, \text{recharge} \}</span></p></li>
<li><p><span class="math inline">R^{\text{search}}</span> = expected number of cans while searching.</p></li>
<li><p><span class="math inline">R^{\text{wait}}</span> = expected number of cans while waiting.</p></li>
<li><p><span class="math inline">R^{\text{search}} &gt; R^{\text{wait}}</span></p></li>
</ul>
<p><img data-src="img/recyclingrobot.png"></p>
</div><div class="column" style="width:50%;">
<ul>
<li>The MDP is fully described by the following table:</li>
</ul>
<p><br></p>
<table class="caption-top">
<colgroup>
<col style="width: 15%">
<col style="width: 15%">
<col style="width: 14%">
<col style="width: 20%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">s</span></th>
<th style="text-align: center;"><span class="math inline">s'</span></th>
<th style="text-align: center;"><span class="math inline">a</span></th>
<th style="text-align: center;"><span class="math inline">p(s' | s, a)</span></th>
<th style="text-align: center;"><span class="math inline">r(s, a, s')</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">high</td>
<td style="text-align: center;">high</td>
<td style="text-align: center;">search</td>
<td style="text-align: center;"><span class="math inline">\alpha</span></td>
<td style="text-align: center;"><span class="math inline">\mathcal{R}^\text{search}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">high</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">search</td>
<td style="text-align: center;"><span class="math inline">1 - \alpha</span></td>
<td style="text-align: center;"><span class="math inline">\mathcal{R}^\text{search}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">low</td>
<td style="text-align: center;">high</td>
<td style="text-align: center;">search</td>
<td style="text-align: center;"><span class="math inline">1 - \beta</span></td>
<td style="text-align: center;"><span class="math inline">-3</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">low</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">search</td>
<td style="text-align: center;"><span class="math inline">\beta</span></td>
<td style="text-align: center;"><span class="math inline">\mathcal{R}^\text{search}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">high</td>
<td style="text-align: center;">high</td>
<td style="text-align: center;">wait</td>
<td style="text-align: center;"><span class="math inline">1</span></td>
<td style="text-align: center;"><span class="math inline">\mathcal{R}^\text{wait}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">high</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">wait</td>
<td style="text-align: center;"><span class="math inline">0</span></td>
<td style="text-align: center;"><span class="math inline">\mathcal{R}^\text{wait}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">low</td>
<td style="text-align: center;">high</td>
<td style="text-align: center;">wait</td>
<td style="text-align: center;"><span class="math inline">0</span></td>
<td style="text-align: center;"><span class="math inline">\mathcal{R}^\text{wait}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">low</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">wait</td>
<td style="text-align: center;"><span class="math inline">1</span></td>
<td style="text-align: center;"><span class="math inline">\mathcal{R}^\text{wait}</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">low</td>
<td style="text-align: center;">high</td>
<td style="text-align: center;">recharge</td>
<td style="text-align: center;"><span class="math inline">1</span></td>
<td style="text-align: center;"><span class="math inline">0</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">low</td>
<td style="text-align: center;">low</td>
<td style="text-align: center;">recharge</td>
<td style="text-align: center;"><span class="math inline">0</span></td>
<td style="text-align: center;"><span class="math inline">0</span></td>
</tr>
</tbody>
</table>
</div></div>
</section>

<section id="the-policy" class="title-slide slide level1 center">
<h1>The policy</h1>

<img data-src="img/rl-agent.jpg" style="width:50.0%" class="r-stretch"><ul>
<li>The probability that an agent selects a particular action <span class="math inline">a</span> in a given state <span class="math inline">s</span> is called the <strong>policy</strong> <span class="math inline">\pi</span>.</li>
</ul>
<p><span class="math display">
\begin{align}
    \pi &amp;: \mathcal{S} \times \mathcal{A} \rightarrow P(\mathcal{S})\\
    (s, a) &amp;\rightarrow \pi(s, a)  = P(a_t = a | s_t = s) \\
\end{align}
</span></p>
<ul>
<li><p>The policy can be <strong>deterministic</strong> (one action has a probability of 1, the others 0) or <strong>stochastic</strong>.</p></li>
<li><p>The goal of an agent is to find a policy that maximizes the sum of received rewards <strong>on the long term</strong>, i.e.&nbsp;the <strong>return</strong> <span class="math inline">R_t</span> at each each time step.</p></li>
<li><p>This policy is called the <strong>optimal policy</strong> <span class="math inline">\pi^*</span>.</p></li>
</ul>
<p><span class="math display">
    \mathcal{J}(\pi) = \mathbb{E}_{\rho_\pi} [R_t] \qquad
    \pi^* = \text{argmax} \, \mathcal{J}(\pi)
</span></p>
</section>

<section id="goal-of-reinforcement-learning" class="title-slide slide level1 center">
<h1>Goal of Reinforcement Learning</h1>
<ul>
<li><p>RL is an <strong>adaptive optimal control</strong> method for Markov Decision Processes using (sparse) rewards as a partial feedback.</p></li>
<li><p>At each time step <span class="math inline">t</span>, the agent observes its Markov state <span class="math inline">s_t \in \mathcal{S}</span>, produces an action <span class="math inline">a_t \in \mathcal{A}(s_t)</span>, receives a reward according to this action <span class="math inline">r_{t+1} \in \Re</span> and updates its state: <span class="math inline">s_{t+1} \in \mathcal{S}</span>.</p></li>
</ul>
<div>
<p><img data-src="img/rl-sequence.jpg" style="width:60.0%"></p>
</div>
<ul>
<li><p>The agent generates trajectories <span class="math inline">\tau = (s_0, a_0, r_1, s_1, a_1, \ldots, s_T)</span> depending on its policy <span class="math inline">\pi(s ,a)</span>.</p></li>
<li><p>The return of a trajectory is the (discounted) sum of rewards accumulated during the sequence: <span class="math display"> R(\tau) = \sum_{t=0}^{T} \gamma^t \, r_{t+1} </span></p></li>
<li><p>The goal is to find the <strong>optimal policy</strong> <span class="math inline">\pi^* (s, a)</span> that maximizes in expectation the return of each possible trajectory under that policy:</p></li>
</ul>
<p><span class="math display">
    \mathcal{J}(\pi) = \mathbb{E}_{\tau \sim \rho_\pi} [R(\tau)] \qquad
    \pi^* = \text{argmax} \, \mathcal{J}(\pi)
</span></p>
</section>

<section id="bellman-equations" class="title-slide slide level1 center">
<h1>2 - Bellman equations</h1>

</section>

<section id="value-functions" class="title-slide slide level1 center">
<h1>Value Functions</h1>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><p>A central notion in RL is to estimate the <strong>value</strong> (or <strong>utility</strong>) of every state and action of the MDP.</p></li>
<li><p>The value of a state <span class="math inline">V^{\pi} (s)</span> is the expected return when starting from that state and thereafter following the agent’s current policy <span class="math inline">\pi</span>.</p></li>
<li><p>The <strong>state-value function</strong> <span class="math inline">V^{\pi} (s)</span> of a state <span class="math inline">s</span> given the policy <span class="math inline">\pi</span> is defined as the mathematical expectation of the return after that state:</p></li>
</ul>
<p><span class="math display">  V^{\pi} (s) = \mathbb{E}_{\rho_\pi} ( R_t | s_t = s) = \mathbb{E}_{\rho_\pi} ( \sum_{k=0}^{\infty} \gamma^k r_{t+k+1} |s_t=s ) </span></p>
</div><div class="column" style="width:40%;">
<p><img data-src="img/rewardtogo.png"></p>
</div></div>
</section>

<section id="value-functions-1" class="title-slide slide level1 center">
<h1>Value Functions</h1>
<div class="columns">
<div class="column" style="width:60%;">
<p><span class="math display">  V^{\pi} (s) = \mathbb{E}_{\rho_\pi} ( R_t | s_t = s) = \mathbb{E}_{\rho_\pi} ( \sum_{k=0}^{\infty} \gamma^k r_{t+k+1} |s_t=s ) </span></p>
<ul>
<li><p>The mathematical expectation operator <span class="math inline">\mathbb{E}(\cdot)</span> is indexed by <span class="math inline">\rho_\pi</span>, the probability distribution of states achievable with <span class="math inline">\pi</span>.</p></li>
<li><p>Several trajectories are possible after the state <span class="math inline">s</span>:</p>
<ul>
<li><p>The <strong>state transition probability function</strong> <span class="math inline">p(s' | s, a)</span> leads to different states <span class="math inline">s'</span>, even if the same actions are taken.</p></li>
<li><p>The <strong>expected reward function</strong> <span class="math inline">r(s, a, s')</span> provides stochastic rewards, even if the transition <span class="math inline">(s, a, s')</span> is the same.</p></li>
<li><p>The <strong>policy</strong> <span class="math inline">\pi</span> itself is stochastic.</p></li>
</ul></li>
<li><p>Only rewards that are obtained using the policy <span class="math inline">\pi</span> should be taken into account, not the complete distribution of states and rewards.</p></li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="img/rewardtogo.png"></p>
</div></div>
</section>

<section id="value-functions-2" class="title-slide slide level1 center">
<h1>Value Functions</h1>
<ul>
<li>The value of a state is not intrinsic to the state itself, it depends on the policy:</li>
</ul>
<p><span class="math display">V^{\pi} (s) = \mathbb{E}_{\rho_\pi} ( R_t | s_t = s) = \mathbb{E}_{\rho_\pi} ( \sum_{k=0}^{\infty} \gamma^k r_{t+k+1} |s_t=s )</span></p>
<ul>
<li>One could be in a state which is very close to the goal (only one action left to win game), but if the policy is very bad, the “good” action will not be chosen and the state will have a small value.</li>
</ul>

<img data-src="img/goalmiss.gif" class="r-stretch quarto-figure-center"><p class="caption">Source: <a href="https://www.carbonated.tv/sports/worst-open-goal-misses-in-football-gifs" class="uri">https://www.carbonated.tv/sports/worst-open-goal-misses-in-football-gifs</a></p></section>

<section id="value-functions-3" class="title-slide slide level1 center">
<h1>Value Functions</h1>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><p>The value of taking an action <span class="math inline">a</span> in a state <span class="math inline">s</span> under policy <span class="math inline">\pi</span> is the expected return starting from that state, taking that action, and thereafter following the following <span class="math inline">\pi</span>.</p></li>
<li><p>The <strong>action-value function</strong> for a state-action pair <span class="math inline">(s, a)</span> under the policy <span class="math inline">\pi</span> (or <strong>Q-value</strong>) is defined as:</p></li>
</ul>
<p><span class="math display">\begin{align}
    Q^{\pi} (s, a)  &amp; = \mathbb{E}_{\rho_\pi} ( R_t | s_t = s, a_t =a) \\
                    &amp; = \mathbb{E}_{\rho_\pi} ( \sum_{k=0}^{\infty} \gamma^k r_{t+k+1} |s_t=s, a_t=a) \\
\end{align}</span></p>
<ul>
<li>State- and action-value functions are linked to each other.</li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="img/rewardtogo.png"></p>
</div></div>
</section>

<section id="the-v-and-q-value-functions-are-inter-dependent" class="title-slide slide level1 center">
<h1>The V and Q value functions are inter-dependent</h1>
<div>
<p><img data-src="img/backup.png" style="width:30.0%"></p>
</div>
<ul>
<li>The value of a state <span class="math inline">V^{\pi}(s)</span> depends on the value <span class="math inline">Q^{\pi} (s, a)</span> of the action that will be chosen by the policy <span class="math inline">\pi</span> in <span class="math inline">s</span>:</li>
</ul>
<p><span class="math display">
        V^{\pi}(s) = \mathbb{E}_{a \sim \pi(s,a)} [Q^{\pi} (s, a)] = \sum_{a \in \mathcal{A}(s)} \pi(s, a) \, Q^{\pi} (s, a)
</span></p>
<ul>
<li><p>If the policy <span class="math inline">\pi</span> is deterministic (the same action is chosen every time), the value of the state is the same as the value of that action (same expected return).</p></li>
<li><p>If the policy <span class="math inline">\pi</span> is stochastic (actions are chosen with different probabilities), the value of the state is the weighted average of the value of the actions.</p></li>
<li><p>If the Q-values are known, the V-values can be found easily.</p></li>
</ul>
</section>

<section id="values-and-immediate-rewards" class="title-slide slide level1 center">
<h1>Values and immediate rewards</h1>
<ul>
<li>We can note that the return at time <span class="math inline">t</span> depends on the <strong>immediate reward</strong> <span class="math inline">r_{t+1}</span> and the return at the next time step <span class="math inline">t+1</span>:</li>
</ul>
<p><span class="math display">
\begin{aligned}
    R_t &amp;= r_{t+1} + \gamma \, r_{t+2} +  \gamma^2  \, r_{t+3} + \dots + \gamma^k \, r_{t+k+1} + \dots \\
        &amp;= r_{t+1} + \gamma \, ( r_{t+2} +  \gamma \, r_{t+3} + \dots + \gamma^{k-1} \, r_{t+k+1} + \dots) \\
        &amp;= r_{t+1} + \gamma \,  R_{t+1} \\
\end{aligned}
</span></p>
<ul>
<li>When taking the mathematical expectation of that identity, we obtain:</li>
</ul>
<p><span class="math display">
    \mathbb{E}_{\rho_\pi}[R_t] = r(s_t, a_t, s_{t+1}) + \gamma \, \mathbb{E}_{\rho_\pi}[R_{t+1}]
</span></p>
<ul>
<li>It becomes clear that the value of an action depends on the immediate reward received just after the action, as well as the value of the next state:</li>
</ul>
<p><span class="math display">
        Q^{\pi}(s_t, a_t) = r(s_t, a_t, s_{t+1}) + \gamma \,  V^{\pi} (s_{t+1})
</span></p>
<ul>
<li>But that is only for a fixed <span class="math inline">(s_t, a_t, s_{t+1})</span> transition.</li>
</ul>
</section>

<section id="the-v-and-q-value-functions-are-inter-dependent-1" class="title-slide slide level1 center">
<h1>The V and Q value functions are inter-dependent</h1>
<div>
<p><img data-src="img/backup.png" style="width:30.0%"></p>
</div>
<ul>
<li>Taking transition probabilities into account, one can obtain the Q-values when the V-values are known:</li>
</ul>
<p><span class="math display">
        Q^{\pi}(s, a) = \mathbb{E}_{s' \sim p(s'|s, a)} [ r(s, a, s') + \gamma \, V^{\pi} (s') ] = \sum_{s' \in \mathcal{S}} p(s' | s, a) \, [ r(s, a, s') + \gamma \, V^{\pi} (s') ]
</span></p>
<ul>
<li><p>The value of an action depends on:</p>
<ul>
<li><p>the states <span class="math inline">s'</span> one can arrive after the action (with a probability <span class="math inline">p(s' | s, a)</span>).</p></li>
<li><p>the value of that state <span class="math inline">V^{\pi} (s')</span>, weighted by <span class="math inline">\gamma</span> as it is one step in the future.</p></li>
<li><p>the reward received immediately after taking that action <span class="math inline">r(s, a, s')</span> (as it is not included in the value of <span class="math inline">s'</span>).</p></li>
</ul></li>
</ul>
</section>

<section id="bellman-equation-for-vpi" class="title-slide slide level1 center">
<h1>Bellman equation for <span class="math inline">V^{\pi}</span></h1>

<img data-src="img/backup.png" style="width:30.0%" class="r-stretch"><ul>
<li>A fundamental property of value functions used throughout reinforcement learning is that they satisfy a particular recursive relationship:</li>
</ul>
<p><span class="math display">
\begin{aligned}
        V^{\pi}(s)  &amp;= \sum_{a \in \mathcal{A}(s)} \pi(s, a) \, Q^{\pi} (s, a)\\
                    &amp;= \sum_{a \in \mathcal{A}(s)} \pi(s, a) \, \sum_{s' \in \mathcal{S}} p(s' | s, a) \, [ r(s, a, s') + \gamma \, V^{\pi} (s') ]
\end{aligned}
</span></p>
<ul>
<li><p>This equation is called the <strong>Bellman equation</strong> for <span class="math inline">V^{\pi}</span>.</p></li>
<li><p>It expresses the relationship between the value of a state and the value of its successors, depending on the dynamics of the MDP (<span class="math inline">p(s' | s, a)</span> and <span class="math inline">r(s, a, s')</span>) and the current policy <span class="math inline">\pi</span>.</p></li>
<li><p>The interesting property of the Bellman equation for RL is that it admits one and only one solution <span class="math inline">V^{\pi}(s)</span>.</p></li>
</ul>
</section>

<section id="bellman-equation-for-qpi" class="title-slide slide level1 center">
<h1>Bellman equation for <span class="math inline">Q^{\pi}</span></h1>
<ul>
<li>The same recursive relationship stands for <span class="math inline">Q^{\pi}(s, a)</span>:</li>
</ul>
<p><span class="math display">
\begin{aligned}
        Q^{\pi}(s, a)  &amp;= \sum_{s' \in \mathcal{S}} p(s' | s, a) \, [ r(s, a, s') + \gamma \, V^{\pi} (s') ] \\
                    &amp;=  \sum_{s' \in \mathcal{S}} p(s' | s, a) \, [ r(s, a, s') + \gamma \, \sum_{a' \in \mathcal{A}(s')} \pi(s', a') \, Q^{\pi} (s', a')]
\end{aligned}
</span></p>
<p>which is called the <strong>Bellman equation</strong> for <span class="math inline">Q^{\pi}</span>.</p>
<ul>
<li>The following <strong>backup diagrams</strong> denote these recursive relationships.</li>
</ul>
<div>
<p><img data-src="img/backup-V.png" style="width:70.0%"></p>
</div>
</section>

<section id="bellman-optimality-equations" class="title-slide slide level1 center">
<h1>3 - Bellman optimality equations</h1>

</section>

<section id="optimal-policy" class="title-slide slide level1 center">
<h1>Optimal policy</h1>
<ul>
<li><p>The optimal policy is the policy that gathers the maximum of reward on the long term.</p></li>
<li><p>Value functions define a partial ordering over policies:</p></li>
</ul>
<div class="callout callout-tip no-icon callout-titled callout-style-simple">
<div class="callout-body">
<div class="callout-title">
<p><strong>Partial ordering</strong></p>
</div>
<div class="callout-content">
<p>A policy <span class="math inline">\pi</span> is better than another policy <span class="math inline">\pi'</span> if its expected return is greater or equal than that of <span class="math inline">\pi'</span> for all states <span class="math inline">s</span>.</p>
<p><span class="math display">
        \pi \geq \pi' \Leftrightarrow V^{\pi}(s) \geq V^{\pi'}(s) \quad \forall s \in \mathcal{S}
</span></p>
</div>
</div>
</div>
<ul>
<li><p>For a MDP, there exists at least one policy that is better than all the others: this is the <strong>optimal policy</strong> <span class="math inline">\pi^*</span>.</p></li>
<li><p>We note <span class="math inline">V^*(s)</span> and <span class="math inline">Q^*(s, a)</span> the optimal value of the different states and actions under <span class="math inline">\pi^*</span>.</p></li>
</ul>
<p><span class="math display">
   V^* (s) = \max_{\pi} V^{\pi}(s) \quad \forall s \in \mathcal{S}
</span></p>
<p><span class="math display">
    Q^* (s, a) = \max_{\pi} Q^{\pi}(s, a) \quad \forall s \in \mathcal{S}, \quad \forall a \in \mathcal{A}
</span></p>
</section>

<section id="the-optimal-policy-is-greedy" class="title-slide slide level1 center">
<h1>The optimal policy is greedy</h1>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li><p>When the policy is optimal <span class="math inline">\pi^*</span>, the link between the V and Q values is even easier.</p></li>
<li><p>The V and Q values are maximal for the optimal policy: there is no better alternative.</p></li>
</ul>
</div><div class="column" style="width:40%;">
<p><img data-src="img/fullvi.png"></p>
</div></div>
<ul>
<li><strong>The optimal action <span class="math inline">a^*</span> to perform in the state <span class="math inline">s</span> is the one with the highest optimal Q-value <span class="math inline">Q^*(s, a)</span></strong>.</li>
</ul>
<p><span class="math display">
    a^* = \text{argmax}_a \, Q^*(s, a)
</span></p>
<ul>
<li>By definition, this action will bring the maximal return when starting in <span class="math inline">s</span>.</li>
</ul>
<p><span class="math display">
    Q^*(s, a) = \mathbb{E}_{\rho_{\pi^*}} [R_t]
</span></p>
<ul>
<li>The optimal policy is <strong>greedy</strong> with respect to <span class="math inline">Q^*(s, a)</span>, i.e.&nbsp;<strong>deterministic</strong>.</li>
</ul>
<p><span class="math display">
    \pi^*(s, a) = \begin{cases}
                1 \; \text{if} \; a = a^* \\
                0 \; \text{otherwise.}
                \end{cases}
</span></p>
</section>

<section id="bellman-optimality-equations-1" class="title-slide slide level1 center">
<h1>Bellman optimality equations</h1>
<div class="columns">
<div class="column" style="width:60%;">
<ul>
<li>As the optimal policy is deterministic, the optimal value of a state is equal to the value of the optimal action:</li>
</ul>
<p><span class="math display">
    V^* (s)  = \max_{a \in \mathcal{A}(s)} Q^{\pi^*} (s, a)
</span></p>
</div><div class="column" style="width:40%;">
<p><img data-src="img/fullvi.png"></p>
</div></div>
<ul>
<li><p>The expected return after being in <span class="math inline">s</span> is the same as the expected return after being in <span class="math inline">s</span> and choosing the optimal action <span class="math inline">a^*</span>, as this is the only action that can be taken.</p></li>
<li><p>This allows to find the <strong>Bellman optimality equation</strong> for <span class="math inline">V^*</span>:</p></li>
</ul>
<p><span class="math display">
    V^* (s)  = \max_{a \in \mathcal{A}(s)} \sum_{s' \in \mathcal{S}}  p(s' | s, a) \, [ r(s, a, s') + \gamma \, V^{*} (s') ]
</span></p>
<ul>
<li>The same Bellman optimality equation stands for <span class="math inline">Q^*</span>:</li>
</ul>
<p><span class="math display">
    Q^* (s, a)  = \sum_{s' \in \mathcal{S}} p(s' | s, a) \, [r(s, a, s')  + \gamma \max_{a' \in \mathcal{A}(s')} Q^* (s', a') ]
</span></p>
<ul>
<li>The optimal value of <span class="math inline">(s, a)</span> depends on the optimal action in the next state <span class="math inline">s'</span>.</li>
</ul>
</section>

<section id="bellman-optimality-equations-2" class="title-slide slide level1 center">
<h1>Bellman optimality equations</h1>
<ul>
<li><p>The Bellman optimality equations for <span class="math inline">V^*</span> form a system of equations:</p>
<ul>
<li>If there are <span class="math inline">N</span> states <span class="math inline">s</span>, there are <span class="math inline">N</span> Bellman equations with <span class="math inline">N</span> unknowns <span class="math inline">V^*(s)</span>.</li>
</ul></li>
</ul>
<p><span class="math display">
    V^* (s)  = \max_{a \in \mathcal{A}(s)} \sum_{s' \in \mathcal{S}}  p(s' | s, a) \, [ r(s, a, s') + \gamma \, V^{*} (s') ]
</span></p>
<ul>
<li><p>If the dynamics of the environment are known (<span class="math inline">p(s' | s, a)</span> and <span class="math inline">r(s, a, s')</span>), then in principle one can solve this system of equations using linear algebra.</p></li>
<li><p>For finite MDPs, the Bellman optimality equation for <span class="math inline">V^*</span> has a unique solution (one and only one).</p>
<ul>
<li>This is the principle of <strong>dynamic programming</strong>.</li>
</ul></li>
<li><p>The same is true for the Bellman optimality equation for <span class="math inline">Q^*</span>:</p>
<ul>
<li>If there are <span class="math inline">N</span> states and <span class="math inline">M</span> actions available, there are <span class="math inline">N\times M</span> equations with <span class="math inline">N\times M</span> unknowns <span class="math inline">Q^*(s, a)</span>.</li>
</ul></li>
</ul>
<p><span class="math display">
    Q^* (s, a)  = \sum_{s' \in \mathcal{S}} p(s' | s, a) \, [r(s, a, s')  + \gamma \max_{a' \in \mathcal{A}(s')} Q^* (s', a') ]
</span></p>
</section>

<section id="obtaining-the-optimal-policy-from-the-optimal-values" class="title-slide slide level1 center">
<h1>Obtaining the optimal policy from the optimal values</h1>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li><span class="math inline">V^*</span> and <span class="math inline">Q^*</span> are interdependent: one needs only to compute one of them.</li>
</ul>
<p><span class="math display">V^* (s)  = \max_{a \in \mathcal{A}(s)} \, Q^{*} (s, a)</span></p>
<p><span class="math display">Q^* (s, a)  = \sum_{s' \in \mathcal{S}} \, p(s' | s, a) \, [r(s, a, s') + \gamma V^*(s') ] </span></p>
</div><div class="column" style="width:30%;">
<p><img data-src="img/fullvi.png"></p>
</div></div>
<ul>
<li>If you only have <span class="math inline">V^*(s)</span>, you need to perform a <strong>one-step-ahead</strong> search using the dynamics of the MDP:</li>
</ul>
<p><span class="math display">
    Q^* (s, a)  = \sum_{s' \in \mathcal{S}} \, p(s' | s, a) \, [r(s, a, s') + \gamma V^*(s') ]
</span></p>
<p>and then select the optimal action with the highest <span class="math inline">Q^*</span>-value.</p>
<ul>
<li>Using the <span class="math inline">V^*(s)</span> values is called <strong>model-based</strong>: you need to know the model of the environment to act, at least locally.</li>
</ul>
</section>

<section id="bellman-optimality-equations-for-v-or-q" class="title-slide slide level1 center">
<h1>Bellman optimality equations for <span class="math inline">V^*</span> or <span class="math inline">Q^*</span>?</h1>
<div class="columns">
<div class="column" style="width:70%;">
<ul>
<li>If you have all <span class="math inline">Q^*(s, a)</span>, the optimal policy is straightforward:</li>
</ul>
<p><span class="math display">
    \pi^*(s, a) = \begin{cases}
                1 \; \text{if} \; a = \text{argmax}_a \, Q^*(s, a) \\
                0 \; \text{otherwise.}
                \end{cases}
</span></p>
</div><div class="column" style="width:30%;">
<p><img data-src="img/fullvi.png"></p>
</div></div>
<ul>
<li><p>Finding <span class="math inline">Q^*</span> makes the selection of optimal actions easy:</p>
<ul>
<li><p>no need to iterate over all actions and to know the dynamics <span class="math inline">p(s' | s, a)</span> and <span class="math inline">r(s, a, s')</span>.</p></li>
<li><p>for any state <span class="math inline">s</span>, it can simply find the action that maximizes <span class="math inline">Q^*(s,a)</span>.</p></li>
</ul></li>
<li><p>The action-value function effectively <strong>caches</strong> the results of all one-step-ahead searches into a single value: <strong>model-free</strong>.</p></li>
<li><p>At the cost of representing a function of all state-action pairs, the optimal action-value function allows optimal actions to be selected without having to know anything about the environment’s dynamics.</p></li>
<li><p>But there are <span class="math inline">N \times M</span> equations to solve instead of just <span class="math inline">N</span>…</p></li>
</ul>
</section>

<section id="how-to-solve-the-bellman-equations" class="title-slide slide level1 center">
<h1>How to solve the Bellman equations?</h1>
<ul>
<li><p>Finding an optimal policy by solving the <strong>Bellman optimality equations</strong> requires the following:</p>
<ul>
<li><p>accurate knowledge of environment dynamics <span class="math inline">p(s' | s, a)</span> and <span class="math inline">r(s, a, s')</span> for all transitions;</p></li>
<li><p>enough memory and time to do the computations;</p></li>
<li><p>the Markov property.</p></li>
</ul></li>
<li><p>How much space and time do we need? A solution requires an exhaustive search, looking ahead at all possibilities, computing their probabilities of occurrence and their desirability in terms of expected rewards.</p></li>
<li><p>The number of states is often huge or astronomical (e.g., Go has about <span class="math inline">10^{170}</span> states).</p></li>
<li><p><strong>Dynamic programming</strong> solves exactly the Bellman equations.</p></li>
<li><p><strong>Monte-Carlo</strong> and <strong>temporal-difference</strong> methods approximate them.</p></li>
</ul>
</section>

<section id="key-idea-of-reinforcement-learning-generalized-policy-iteration" class="title-slide slide level1 center">
<h1>Key idea of Reinforcement learning: Generalized Policy Iteration</h1>
<div class="columns">
<div class="column" style="width:40%;">
<p><img data-src="img/gpi-scheme.png"></p>
</div><div class="column" style="width:60%;">
<ul>
<li><p>RL algorithms iterate over two steps:</p>
<ol type="1">
<li><p><strong>Policy evaluation</strong></p>
<ul>
<li><p>For a given policy <span class="math inline">\pi</span>, the value of all states <span class="math inline">V^\pi(s)</span> or all state-action pairs <span class="math inline">Q^\pi(s, a)</span> is calculated, either based on:</p>
<ul>
<li><p>the Bellman equations (Dynamic Programming)</p></li>
<li><p>sampled experience (Monte-Carlo and Temporal Difference)</p></li>
</ul></li>
</ul></li>
<li><p><strong>Policy improvement</strong></p>
<ul>
<li>From the current estimated values <span class="math inline">V^\pi(s)</span> or <span class="math inline">Q^\pi(s, a)</span>, a new <strong>better</strong> policy <span class="math inline">\pi</span> is derived.</li>
</ul></li>
</ol></li>
<li><p>After enough iterations, the policy converges to the <strong>optimal policy</strong> (if the states are Markov).</p></li>
</ul>
</div></div>
</section>

<section id="different-notations-in-rl" class="title-slide slide level1 center">
<h1>Different notations in RL</h1>
<ul>
<li><p>Notations can vary depending on the source.</p></li>
<li><p>The ones used in this course use what you can read in most modern deep RL papers (Deepmind, OpenAI), but beware that you can encounter <span class="math inline">G_t</span> for the return…</p></li>
</ul>
<table class="caption-top">
<colgroup>
<col style="width: 23%">
<col style="width: 23%">
<col style="width: 22%">
<col style="width: 30%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"></th>
<th style="text-align: center;"><strong>This course</strong></th>
<th style="text-align: center;"><strong>Sutton and Barto 1998</strong></th>
<th style="text-align: center;"><strong>Sutton and Barto 2017</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Current state</td>
<td style="text-align: center;"><span class="math inline">s_t</span></td>
<td style="text-align: center;"><span class="math inline">s_t</span></td>
<td style="text-align: center;"><span class="math inline">S_t</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Selected action</td>
<td style="text-align: center;"><span class="math inline">a_t</span></td>
<td style="text-align: center;"><span class="math inline">a_t</span></td>
<td style="text-align: center;"><span class="math inline">A_t</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Sampled reward</td>
<td style="text-align: center;"><span class="math inline">r_{t+1}</span></td>
<td style="text-align: center;"><span class="math inline">r_{t+1}</span></td>
<td style="text-align: center;"><span class="math inline">R_{t+1}</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Transition probability</td>
<td style="text-align: center;"><span class="math inline">p(s' | s,a)</span></td>
<td style="text-align: center;"><span class="math inline">\mathcal{P}_{ss'}^a</span></td>
<td style="text-align: center;"><span class="math inline">p(s'|s, a)</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">Expected reward</td>
<td style="text-align: center;"><span class="math inline">r(s,a, s')</span></td>
<td style="text-align: center;"><span class="math inline">\mathcal{R}_{ss'}^a</span></td>
<td style="text-align: center;"><span class="math inline">r(s, a, s')</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Return</td>
<td style="text-align: center;"><span class="math inline">R_t</span></td>
<td style="text-align: center;"><span class="math inline">R_t</span></td>
<td style="text-align: center;"><span class="math inline">G_t</span></td>
</tr>
<tr class="odd">
<td style="text-align: center;">State value function</td>
<td style="text-align: center;"><span class="math inline">V^\pi(s)</span></td>
<td style="text-align: center;"><span class="math inline">V^\pi(s)</span></td>
<td style="text-align: center;"><span class="math inline">v_\pi(s)</span></td>
</tr>
<tr class="even">
<td style="text-align: center;">Action value function</td>
<td style="text-align: center;"><span class="math inline">Q^\pi(s, a)</span></td>
<td style="text-align: center;"><span class="math inline">Q^\pi(s, a)</span></td>
<td style="text-align: center;"><span class="math inline">q_\pi(s, a)</span></td>
</tr>
</tbody>
</table>

<div class="quarto-auto-generated-content">
<div class="footer footer-default">

</div>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":false,"theme":"whiteboard"},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        // For code content inside modals, clipBoardJS needs to be initialized with a container option
        // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp('/' + window.location.host + '/');
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>